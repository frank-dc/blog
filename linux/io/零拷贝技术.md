# Zero-Copy 零拷贝技术
- [Zero-Copy 零拷贝技术](#zero-copy-零拷贝技术)
  - [简介](#简介)
  - [流程](#流程)
  - [传统文件传输流程](#传统文件传输流程)
  - [DMA 拷贝与 CPU 拷贝对比](#dma-拷贝与-cpu-拷贝对比)

## 简介
通过内核直接在内核空间完成数据传输，无需用户态参与。

## 流程
1. 磁盘文件 -> 内核缓冲区（DMA 拷贝）
2. 内核缓冲区 -> 内核 Socket 缓冲区（CPU 拷贝）
3. 内核 Socket 缓冲区 -> 网卡（DMA 拷贝）
2 次上下文切换，1 次 CPU 拷贝

## 传统文件传输流程
1. 磁盘文件 -> 内核缓冲区（DMA 拷贝）
2. 内核缓冲区 -> 用户缓冲区（CPU 拷贝）
3. 用户缓冲区 -> 内核 Socket 缓冲区（CPU 拷贝）
4. 内核 Socket 缓冲区 -> 网卡（DMA 拷贝）

## DMA 拷贝与 CPU 拷贝对比
DMA 拷贝可参考[DMA拷贝](./DMA拷贝.md)

| 指标     | DMA  拷贝                      | CPU 拷贝                   |
| :------- | :----------------------------- | :------------------------- |
| CPU 占用 | 仅需初始化与中断处理，占用率低 | 全程参与数据传输，占用率高 |
| 吞吐量   | 高（适合批量数据）             | 低（受限于 CPU 处理速度）  |
| 适用场景 | 高速外设、大块数据             | 小数据量、简单控制逻辑     |
| 硬件依赖 | 需 DMA 控制器支持              | 无额外硬件要求             |
| | |

